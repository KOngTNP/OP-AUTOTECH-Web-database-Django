{% extends 'layout.html' %}

{% block content %}

{% if user.is_authenticated%}
<body>
  <h2 align="center"> All Drawing </h2>
  <button onclick="ExportToExcel('xlsx')" class="btn btn-secondary btn-lg active" aria-pressed="true" >Export table to excel</button>
  
  <div style="overflow-x: auto;" >
  <table  class="table table-striped js-sort-table" id="tbl_exporttable_to_xls"  border="1">
    <thead class="thead-dark" align="center" >
      <tr>
        <th colspan="5"><h4>DRAWING</h4></th>
        <th colspan="3"><h4>DOCUMENT</h4></th>
        <th colspan="1"><h4>MAKER</h4></th>
        <th colspan="3"><h4>CUTTING</h4></th>
        <th colspan="4"><h4>MACHINE</h4></th>
        <th colspan="3"><h4>QC</h4></th>
        <th colspan="5"><h4>PAINTING</h4></th>
        <th colspan="3"><h4>PAINTING QC</h4></th>
        <th colspan="3"><h4>ASSEMBY</h4></th>
      </tr>

      <tr>
        <th class="align-middle js-sort-string">Job number</th>
        <th class="align-middle js-sort-string">Project name</th>
        <th class="align-middle js-sort-string">Number</th>
        <th class="align-middle js-sort-number">Quantity</th>
        <th class="align-middle">Date</th>

        <th class="align-middle js-sort-number">Quantity</th>
        <th class="align-middle js-sort-string">Username</th>
        <th class="align-middle">Date</th>

        <th class="align-middle js-sort-string">Name</th>

        <th class="align-middle js-sort-number">Quantity</th>
        <th class="align-middle js-sort-string">Username</th>
        <th class="align-middle">Date</th>

        <th class="align-middle js-sort-number">Quantity</th>
        <th class="align-middle js-sort-string">Username</th>
        <th class="align-middle js-sort-number">Machine number</th>
        <th class="align-middle">Date</th>

        <th class="align-middle js-sort-number">Quantity</th>
        <th class="align-middle js-sort-string">Username</th>
        <th class="align-middle">Date</th>

        <th class="align-middle js-sort-string">Company name</th>
        <th class="align-middle js-sort-number">Quantity</th>
        <th class="align-middle js-sort-string">Username</th>
        <th class="align-middle">Start date</th>
        <th class="align-middle">End date</th>

        <th class="align-middle js-sort-number">Quantity</th>
        <th class="align-middle js-sort-string">Username</th>
        <th class="align-middle">Date</th>
        
        <th class="align-middle js-sort-number">Quantity</th>
        <th class="align-middle js-sort-string">Username</th>
        <th class="align-middle">Date</th>
      </tr>
    </thead>
    {% for first_person in first_person %}


    
    <tr align="center" >
      
      <td class="align-middle">{{first_person.Job_number}}</td>
      <td class="align-middle">{{first_person.Project_name}}</td>
      <th class="align-middle">{{first_person.drawingNo}}</th>
      <td class="align-middle">{{first_person.Drawing_QTY}}</td>
      <td class="align-middle">{{first_person.Drawing_date}}</td>
  

      <td class="align-middle">{{first_person.Document_QTY}}</td>
      {% if first_person.Document_user == null%}
        <td class="align-middle">{{first_person.Document_user}}</td>
      {% else %}
        {% for get_user_id in get_user_id %}
          {% if get_user_id.id == first_person.Document_user %}
            <td class="align-middle">{{get_user_id.username}}</td>
          {% endif %}
        {% endfor %}
      {% endif %}
      <td class="align-middle">{{first_person.Document_date}}</td>


      <td class="align-middle">{{first_person.Maker_name}}</td>
      

      <td class="align-middle">{{first_person.Cutting_QTY}}</td>
      {% if first_person.Cutting_user == null%}
        <td class="align-middle">{{first_person.Cutting_user}}</td>
      {% else %}
        {% for get_user_id in get_user_id %}
          {% if get_user_id.id == first_person.Cutting_user %}
            <td class="align-middle">{{get_user_id.username}}</td>
          {% endif %}
        {% endfor %}
      {% endif %}
      <td class="align-middle">{{first_person.Cutting_date}}</td>


      <td class="align-middle">{{first_person.Machine_QTY}}</td>
      {% if first_person.Machine_user == null%}
        <td class="align-middle">{{first_person.Machine_user}}</td>
      {% else %}
        {% for get_user_id in get_user_id %}
          {% if get_user_id.id == first_person.Machine_user %}
            <td class="align-middle">{{get_user_id.username}}</td>
          {% endif %}
        {% endfor %}
      {% endif %}
      <td class="align-middle">{{first_person.Machine_number}}</td>
      <td class="align-middle">{{first_person.Machine_date}}</td>


      <td class="align-middle">{{first_person.Qc_QTY}}</td>
      {% if first_person.Qc_user == null%}
        <td class="align-middle">{{first_person.Qc_user}}</td>
      {% else %}
        {% for get_user_id in get_user_id %}
          {% if get_user_id.id == first_person.Qc_user %}
            <td class="align-middle">{{get_user_id.username}}</td>
          {% endif %}
        {% endfor %}
      {% endif %}
      <td class="align-middle">{{first_person.Qc_date}}</td>


      <td class="align-middle">{{first_person.Painting_name}}</td>
      <td class="align-middle">{{first_person.Painting_QTY}}</td>
      {% if first_person.Painting_user == null%}
        <td class="align-middle">{{first_person.Painting_user}}</td>
      {% else %}
        {% for get_user_id in get_user_id %}
          {% if get_user_id.id == first_person.Painting_user %}
            <td class="align-middle">{{get_user_id.username}}</td>
          {% endif %}
        {% endfor %}
      {% endif %}
      <td class="align-middle">{{first_person.Painting_starting_date}}</td>
      <td class="align-middle">{{first_person.Painting_End_date}}</td>


      <td class="align-middle">{{first_person.Qc_Painting_QTY}}</td>
      {% if first_person.Qc_Painting_user == null%}
        <td class="align-middle">{{first_person.Qc_Painting_user}}</td>
      {% else %}
        {% for get_user_id in get_user_id %}
          {% if get_user_id.id == first_person.Qc_Painting_user %}
            <td class="align-middle">{{get_user_id.username}}</td>
          {% endif %}
        {% endfor %}
      {% endif %}
      <td class="align-middle">{{first_person.Qc_Painting_date}}</td>


      <td class="align-middle">{{first_person.Assemby_QTY}}</td>
      {% if first_person.Assemby_user == null%}
        <td class="align-middle">{{first_person.Assemby_user}}</td>
      {% else %}
        {% for get_user_id in get_user_id %}
          {% if get_user_id.id == first_person.Assemby_user %}
            <td class="align-middle">{{get_user_id.username}}</td>
          {% endif %}
        {% endfor %}
      {% endif %}
      <td class="align-middle">{{first_person.Assemby_date}}</td>
    </tr>
    {% endfor %}
    


  </table>
  <br/>
</div>
</body>
</html>
{% else %}
    <h1 align="center"><a href="/login" >You need to login first</a></h1>
{% endif %}
{% endblock %}